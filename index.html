<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  </head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-42819052-9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-42819052-9');
  </script>
  <style>
    @font-face {
      font-family: 'Product Sans';
      font-style: normal;
      font-weight: 400;
      src: local('Open Sans'), local('OpenSans'), url(https://fonts.gstatic.com/s/productsans/v5/HYvgU2fE2nRJvZ5JFAumwegdm0LZdjqr5-oayXSOefg.woff2) format('woff2');
    }

    h1, h2, h3, h4, h5 {
      color: #555555;
    }

    body {
      font-family: "Product Sans", Helvetica, sans-serif;;
      color: #787878;
      /* background-color: #e5e6e1; */
    }

    a {
      -moz-transition: color 0.2s ease-in-out, border-color 0.2s ease-in-out;
      -webkit-transition: color 0.2s ease-in-out, border-color 0.2s ease-in-out;
      -ms-transition: color 0.2s ease-in-out, border-color 0.2s ease-in-out;
      transition: color 0.2s ease-in-out, border-color 0.2s ease-in-out;
      border-bottom: dotted 1px;
      color: #49bf9d;
      text-decoration: none;
    }

    a:hover {
      border-bottom-color: transparent;
      color: #49bf9d !important;
      text-decoration: none;
    }
  </style>
  <body>
    <div class="container-fluid">
      <h1>PyTorch for Numpy Users.</h1>
      <a href="https://twitter.com/share" class="twitter-share-button" data-text="A cheatsheet for Numpy users to use PyTorch. #machinelearning #pytorch" data-show-count="false" style="font-size:13px;">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
      <iframe src="https://ghbtns.com/github-btn.html?user=wkentaro&repo=pytorch-for-numpy-users&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
      <p>
        A cheatsheet for Numpy users to use PyTorch. To add/edit an entry, see it on
        <a href="https://github.com/wkentaro/pytorch-for-numpy-users" target="_blank">GitHub</a>.
      </p>

      <div class='row'>
<div class='col-md-6'>
<h2>Types</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                 </th><th>PyTorch                                </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.ndarray</pre></td><td style='width: 50%'><pre>
torch.Tensor</pre>               </td></tr>
<tr><td style='width: 50%'><pre>
np.float32</pre></td><td style='width: 50%'><pre>
torch.float32; torch.float</pre> </td></tr>
<tr><td style='width: 50%'><pre>
np.float64</pre></td><td style='width: 50%'><pre>
torch.float64; torch.double</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.float16</pre></td><td style='width: 50%'><pre>
torch.float16; torch.half</pre>  </td></tr>
<tr><td style='width: 50%'><pre>
np.int8</pre>   </td><td style='width: 50%'><pre>
torch.int8</pre>                 </td></tr>
<tr><td style='width: 50%'><pre>
np.uint8</pre>  </td><td style='width: 50%'><pre>
torch.uint8</pre>                </td></tr>
<tr><td style='width: 50%'><pre>
np.int16</pre>  </td><td style='width: 50%'><pre>
torch.int16; torch.short</pre>   </td></tr>
<tr><td style='width: 50%'><pre>
np.int32</pre>  </td><td style='width: 50%'><pre>
torch.int32; torch.int</pre>     </td></tr>
<tr><td style='width: 50%'><pre>
np.int64</pre>  </td><td style='width: 50%'><pre>
torch.int64; torch.long</pre>    </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Ones and zeros</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                       </th><th>PyTorch                        </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.empty((2, 3))</pre></td><td style='width: 50%'><pre>
torch.empty(2, 3)</pre>  </td></tr>
<tr><td style='width: 50%'><pre>
np.empty_like(x)</pre></td><td style='width: 50%'><pre>
torch.empty_like(x)</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.eye</pre>          </td><td style='width: 50%'><pre>
torch.eye</pre>          </td></tr>
<tr><td style='width: 50%'><pre>
np.identity</pre>     </td><td style='width: 50%'><pre>
torch.eye</pre>          </td></tr>
<tr><td style='width: 50%'><pre>
np.ones</pre>         </td><td style='width: 50%'><pre>
torch.ones</pre>         </td></tr>
<tr><td style='width: 50%'><pre>
np.ones_like</pre>    </td><td style='width: 50%'><pre>
torch.ones_like</pre>    </td></tr>
<tr><td style='width: 50%'><pre>
np.zeros</pre>        </td><td style='width: 50%'><pre>
torch.zeros</pre>        </td></tr>
<tr><td style='width: 50%'><pre>
np.zeros_like</pre>   </td><td style='width: 50%'><pre>
torch.zeros_like</pre>   </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>From existing data</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                                                                     </th><th>PyTorch                                                  </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.array([[1, 2], [3, 4]])</pre>                                    </td><td style='width: 50%'><pre>
torch.tensor([[1, 2], [3, 4]])</pre>               </td></tr>
<tr><td style='width: 50%'><pre>
np.array([3.2, 4.3], dtype=np.float16)
np.float16([3.2, 4.3])
</pre></td><td style='width: 50%'><pre>
torch.tensor([3.2, 4.3], dtype=torch.float16)</pre></td></tr>
<tr><td style='width: 50%'><pre>
x.copy()</pre>                                                      </td><td style='width: 50%'><pre>
x.clone()</pre>                                    </td></tr>
<tr><td style='width: 50%'><pre>
x.astype(np.float32)</pre>                                          </td><td style='width: 50%'><pre>
x.type(torch.float32); x.float()</pre>             </td></tr>
<tr><td style='width: 50%'><pre>
np.fromfile(file)</pre>                                             </td><td style='width: 50%'><pre>
torch.tensor(torch.Storage(file))</pre>            </td></tr>
<tr><td style='width: 50%'><pre>
np.frombuffer</pre>                                                 </td><td style='width: 50%'>                                                         </td></tr>
<tr><td style='width: 50%'><pre>
np.fromfunction</pre>                                               </td><td style='width: 50%'>                                                         </td></tr>
<tr><td style='width: 50%'><pre>
np.fromiter</pre>                                                   </td><td style='width: 50%'>                                                         </td></tr>
<tr><td style='width: 50%'><pre>
np.fromstring</pre>                                                 </td><td style='width: 50%'>                                                         </td></tr>
<tr><td style='width: 50%'><pre>
np.load</pre>                                                       </td><td style='width: 50%'><pre>
torch.load</pre>                                   </td></tr>
<tr><td style='width: 50%'><pre>
np.loadtxt</pre>                                                    </td><td style='width: 50%'>                                                         </td></tr>
<tr><td style='width: 50%'><pre>
np.concatenate</pre>                                                </td><td style='width: 50%'><pre>
torch.cat</pre>                                    </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Numerical ranges</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                           </th><th>PyTorch                            </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.arange(10)</pre>       </td><td style='width: 50%'><pre>
torch.arange(10)</pre>       </td></tr>
<tr><td style='width: 50%'><pre>
np.arange(2, 3, 0.1)</pre></td><td style='width: 50%'><pre>
torch.arange(2, 3, 0.1)</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.linspace</pre>         </td><td style='width: 50%'><pre>
torch.linspace</pre>         </td></tr>
<tr><td style='width: 50%'><pre>
np.logspace</pre>         </td><td style='width: 50%'><pre>
torch.logspace</pre>         </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Linear algebra</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                   </th><th>PyTorch                                                                                                     </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.dot</pre>      </td><td style='width: 50%'><pre>
torch.dot   # 1D arrays only
torch.mm    # 2D arrays only
torch.mv    # matrix-vector (2D x 1D)
</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.matmul</pre>   </td><td style='width: 50%'><pre>
torch.matmul</pre>                                                                                    </td></tr>
<tr><td style='width: 50%'><pre>
np.tensordot</pre></td><td style='width: 50%'><pre>
torch.tensordot</pre>                                                                                 </td></tr>
<tr><td style='width: 50%'><pre>
np.einsum</pre>   </td><td style='width: 50%'><pre>
torch.einsum</pre>                                                                                    </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Building matrices</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy              </th><th>PyTorch               </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.diag</pre></td><td style='width: 50%'><pre>
torch.diag</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.tril</pre></td><td style='width: 50%'><pre>
torch.tril</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.triu</pre></td><td style='width: 50%'><pre>
torch.triu</pre></td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Attributes</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                </th><th>PyTorch                      </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
x.shape</pre>  </td><td style='width: 50%'><pre>
x.shape; x.size()</pre></td></tr>
<tr><td style='width: 50%'><pre>
x.strides</pre></td><td style='width: 50%'><pre>
x.stride()</pre>       </td></tr>
<tr><td style='width: 50%'><pre>
x.ndim</pre>   </td><td style='width: 50%'><pre>
x.dim()</pre>          </td></tr>
<tr><td style='width: 50%'><pre>
x.data</pre>   </td><td style='width: 50%'><pre>
x.data</pre>           </td></tr>
<tr><td style='width: 50%'><pre>
x.size</pre>   </td><td style='width: 50%'><pre>
x.nelement()</pre>     </td></tr>
<tr><td style='width: 50%'><pre>
x.dtype</pre>  </td><td style='width: 50%'><pre>
x.dtype</pre>          </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Indexing</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                          </th><th>PyTorch                                             </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
x[0]</pre>               </td><td style='width: 50%'><pre>
x[0]</pre>                                    </td></tr>
<tr><td style='width: 50%'><pre>
x[:, 0]</pre>            </td><td style='width: 50%'><pre>
x[:, 0]</pre>                                 </td></tr>
<tr><td style='width: 50%'><pre>
x[indices]</pre>         </td><td style='width: 50%'><pre>
x[indices]</pre>                              </td></tr>
<tr><td style='width: 50%'><pre>
np.take(x, indices)</pre></td><td style='width: 50%'><pre>
torch.take(x, torch.LongTensor(indices))</pre></td></tr>
<tr><td style='width: 50%'><pre>
x[x != 0]</pre>          </td><td style='width: 50%'><pre>
x[x != 0]</pre>                               </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Shape manipulation</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                                                                            </th><th>PyTorch                                                                                                                     </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
x.reshape</pre>                                                            </td><td style='width: 50%'><pre>
x.reshape; x.view</pre>                                                                                               </td></tr>
<tr><td style='width: 50%'><pre>
x.resize()</pre>                                                           </td><td style='width: 50%'><pre>
x.resize_</pre>                                                                                                       </td></tr>
<tr><td style='width: 50%'>                                                                                 </td><td style='width: 50%'><pre>
x.resize_as_</pre>                                                                                                    </td></tr>
<tr><td style='width: 50%'><pre>
x = np.arange(6).reshape(3, 2, 1)
x.transpose(2, 0, 1)  # 012 -> 201
</pre></td><td style='width: 50%'><pre>
x = torch.arange(6).reshape(3, 2, 1)
x.permute(2, 0, 1); x.transpose(1, 2).transpose(0, 1)  # 012 -> 021 -> 201
</pre></td></tr>
<tr><td style='width: 50%'><pre>
x.flatten</pre>                                                            </td><td style='width: 50%'><pre>
x.view(-1)</pre>                                                                                                      </td></tr>
<tr><td style='width: 50%'><pre>
x.squeeze()</pre>                                                          </td><td style='width: 50%'><pre>
x.squeeze()</pre>                                                                                                     </td></tr>
<tr><td style='width: 50%'><pre>
x[:, None]; np.expand_dims(x, 1)</pre>                                     </td><td style='width: 50%'><pre>
x[:, None]; x.unsqueeze(1)</pre>                                                                                      </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Item selection and manipulation</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                                                                                                  </th><th>PyTorch                                                                                                                                                                                            </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.put</pre>                                                                                     </td><td style='width: 50%'>                                                                                                                                                                                                   </td></tr>
<tr><td style='width: 50%'><pre>
x.put</pre>                                                                                      </td><td style='width: 50%'><pre>
x.put_</pre>                                                                                                                                                                                 </td></tr>
<tr><td style='width: 50%'><pre>
x = np.array([1, 2, 3])
x.repeat(2)  # [1, 1, 2, 2, 3, 3]
</pre>                                 </td><td style='width: 50%'><pre>
x = torch.tensor([1, 2, 3])
x.repeat_interleave(2)  # [1, 1, 2, 2, 3, 3]
x.repeat(2)  # [1, 2, 3, 1, 2, 3]
x.repeat(2).reshape(2, -1).transpose(1, 0).reshape(-1)
# [1, 1, 2, 2, 3, 3]
</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.tile(x, (3, 2))</pre>                                                                         </td><td style='width: 50%'><pre>
x.repeat(3, 2)</pre>                                                                                                                                                                         </td></tr>
<tr><td style='width: 50%'><pre>
x = np.array([[0, 1], [2, 3], [4, 5]])
idxs = np.array([0, 2])
np.choose(idxs, x) # [0, 5]
</pre></td><td style='width: 50%'><pre>
x = torch.tensor([[0, 1], [2, 3], [4, 5]])
idxs = torch.tensor([0, 2])
x[idxs, torch.arange(x.shape[1])] # [0, 5]
torch.gather(x, 0, idxs[None, :])[0] # [0, 5]
</pre>                       </td></tr>
<tr><td style='width: 50%'><pre>
np.sort</pre>                                                                                    </td><td style='width: 50%'><pre>
sorted, indices = torch.sort(x, [dim])</pre>                                                                                                                                                 </td></tr>
<tr><td style='width: 50%'><pre>
np.argsort</pre>                                                                                 </td><td style='width: 50%'><pre>
sorted, indices = torch.sort(x, [dim])</pre>                                                                                                                                                 </td></tr>
<tr><td style='width: 50%'><pre>
np.nonzero</pre>                                                                                 </td><td style='width: 50%'><pre>
torch.nonzero</pre>                                                                                                                                                                          </td></tr>
<tr><td style='width: 50%'><pre>
np.where</pre>                                                                                   </td><td style='width: 50%'><pre>
torch.where</pre>                                                                                                                                                                            </td></tr>
<tr><td style='width: 50%'><pre>
x[::-1]</pre>                                                                                    </td><td style='width: 50%'><pre>
torch.flip(x, [0])</pre>                                                                                                                                                                     </td></tr>
<tr><td style='width: 50%'><pre>
np.unique(x)</pre>                                                                               </td><td style='width: 50%'><pre>
torch.unique(x)</pre>                                                                                                                                                                        </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Calculation</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                    </th><th>PyTorch                              </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
x.min</pre>        </td><td style='width: 50%'><pre>
x.min</pre>                    </td></tr>
<tr><td style='width: 50%'><pre>
x.argmin</pre>     </td><td style='width: 50%'><pre>
x.argmin</pre>                 </td></tr>
<tr><td style='width: 50%'><pre>
x.max</pre>        </td><td style='width: 50%'><pre>
x.max</pre>                    </td></tr>
<tr><td style='width: 50%'><pre>
x.argmax</pre>     </td><td style='width: 50%'><pre>
x.argmax</pre>                 </td></tr>
<tr><td style='width: 50%'><pre>
x.clip</pre>       </td><td style='width: 50%'><pre>
x.clamp</pre>                  </td></tr>
<tr><td style='width: 50%'><pre>
x.round</pre>      </td><td style='width: 50%'><pre>
x.round</pre>                  </td></tr>
<tr><td style='width: 50%'><pre>
np.floor(x)</pre>  </td><td style='width: 50%'><pre>
torch.floor(x); x.floor()</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.ceil(x)</pre>   </td><td style='width: 50%'><pre>
torch.ceil(x); x.ceil()</pre>  </td></tr>
<tr><td style='width: 50%'><pre>
x.trace</pre>      </td><td style='width: 50%'><pre>
x.trace</pre>                  </td></tr>
<tr><td style='width: 50%'><pre>
x.sum</pre>        </td><td style='width: 50%'><pre>
x.sum</pre>                    </td></tr>
<tr><td style='width: 50%'><pre>
x.sum(axis=0)</pre></td><td style='width: 50%'><pre>
x.sum(0)</pre>                 </td></tr>
<tr><td style='width: 50%'><pre>
x.cumsum</pre>     </td><td style='width: 50%'><pre>
x.cumsum</pre>                 </td></tr>
<tr><td style='width: 50%'><pre>
x.mean</pre>       </td><td style='width: 50%'><pre>
x.mean</pre>                   </td></tr>
<tr><td style='width: 50%'><pre>
x.std</pre>        </td><td style='width: 50%'><pre>
x.std</pre>                    </td></tr>
<tr><td style='width: 50%'><pre>
x.prod</pre>       </td><td style='width: 50%'><pre>
x.prod</pre>                   </td></tr>
<tr><td style='width: 50%'><pre>
x.cumprod</pre>    </td><td style='width: 50%'><pre>
x.cumprod</pre>                </td></tr>
<tr><td style='width: 50%'><pre>
x.all</pre>        </td><td style='width: 50%'><pre>
x.all</pre>                    </td></tr>
<tr><td style='width: 50%'><pre>
x.any</pre>        </td><td style='width: 50%'><pre>
x.any</pre>                    </td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Arithmetic and comparison operations</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                       </th><th>PyTorch         </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.less</pre>         </td><td style='width: 50%'><pre>
x.lt</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.less_equal</pre>   </td><td style='width: 50%'><pre>
x.le</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.greater</pre>      </td><td style='width: 50%'><pre>
x.gt</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.greater_equal</pre></td><td style='width: 50%'><pre>
x.ge</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.equal</pre>        </td><td style='width: 50%'><pre>
x.eq</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.not_equal</pre>    </td><td style='width: 50%'><pre>
x.ne</pre></td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Random numbers</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy                               </th><th>PyTorch                      </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.random.seed</pre>          </td><td style='width: 50%'><pre>
torch.manual_seed</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.random.permutation(5)</pre></td><td style='width: 50%'><pre>
torch.randperm(5)</pre></td></tr>
</tbody>
</table></div>
</div>
<div class='col-md-6'>
<h2>Numerical operations</h2>
<div class='table-responsive'><table class='table table-bordered table-hover'>
<thead>
<tr><th>Numpy              </th><th>PyTorch               </th></tr>
</thead>
<tbody>
<tr><td style='width: 50%'><pre>
np.sign</pre></td><td style='width: 50%'><pre>
torch.sign</pre></td></tr>
<tr><td style='width: 50%'><pre>
np.sqrt</pre></td><td style='width: 50%'><pre>
torch.sqrt</pre></td></tr>
</tbody>
</table></div>
</div>
</div>
    </div>
  </body>
</html>

